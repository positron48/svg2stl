# SVG to STL Converter

Скрипт на Python для преобразования SVG-файлов (в частности, негативных масок печатных плат, экспортированных из KiCad) в 3D-модели формата STL для фотополимерной печати.

## Описание

Этот инструмент автоматизирует процесс преобразования SVG-файлов, экспортированных из KiCad (с черной заливкой, представляющей негатив маски печатной платы), в точные 3D-модели в формате STL для использования с фотополимерными принтерами, такими как Photon Mono X6KS.

## Особенности

- Преобразование SVG-файлов в высококачественные 3D-модели STL
- Точное определение и извлечение только черных элементов из SVG (трасс и контуров плат)
- Автоматическая обрезка до фактических границ содержимого, значительно уменьшающая размер модели
- Обработка отдельных файлов или всех SVG-файлов в каталоге
- Настраиваемые параметры для толщины, размера пикселя и разрешения
- Оптимизированный алгоритм для быстрой обработки больших изображений
- Индикатор прогресса для отслеживания процесса конвертации

## Требования

Скрипт требует Python 3 и следующие пакеты:
```
numpy
cairosvg
pillow
numpy-stl
tqdm
```

Установка зависимостей:
```
pip install -r requirements.txt
```

## Использование

### Преобразование одного SVG-файла:

```
python3 svg2stl.py input.svg --thickness 1.0 --pixel_size 0.05 --dpi 300 --max_size 1000
```

### Преобразование всех SVG-файлов в текущем каталоге:

```
python3 svg2stl.py --all --thickness 1.0 --pixel_size 0.05 --dpi 300 --max_size 1000
```

### Параметры:

- `--thickness`: Толщина результирующей 3D-модели в мм (по умолчанию: 1.0)
- `--pixel_size`: Размер каждого пикселя в мм (по умолчанию: 0.05)
- `--dpi`: Разрешение для растеризации в DPI (по умолчанию: 300)
- `--max_size`: Максимальный размер изображения в пикселях для обработки (по умолчанию: 1000)
- `--debug`: Сохранять отладочные изображения и промежуточные файлы

## Рекомендации по производительности

Для больших SVG-файлов рекомендуется использовать следующие параметры для быстрой обработки:

```
python svg2stl.py input.svg --thickness 1.0 --pixel_size 0.1 --dpi 150 --max_size 500
```

Эти параметры обеспечивают хороший баланс между качеством модели и скоростью обработки. Благодаря умной обрезке по содержимому скрипт обрабатывает только фактические элементы платы, игнорируя пустые поля.

**Пример производительности:**
- Размер исходного SVG: ~43KB
- Преобразование SVG в STL: менее 1 секунды
- Размер выходного STL: ~8MB (до оптимизации было ~34MB)

## Процесс преобразования

1. SVG-файл растеризуется в PNG-изображение с заданным DPI
2. Выполняется извлечение только черных элементов из SVG (трасс и контуров плат)
3. Изображение автоматически обрезается до фактических границ содержимого, игнорируя пустые поля
4. Изображение масштабируется до оптимального размера для обработки
5. Создается бинарная маска, представляющая тело печатной платы
6. Каждый пиксель в маске выдавливается для создания 3D-модели с указанной толщиной
7. Модель сохраняется в виде STL-файла с тем же базовым именем, что и входной SVG

## Примеры

Преобразование экспорта медного слоя KiCad в STL толщиной 0.8 мм:
```
python svg2stl.py board-F_Cu.svg --thickness 0.8 --pixel_size 0.05 --dpi 300
```

Обработка всех SVG-файлов с более высоким разрешением:
```
python svg2stl.py --all --thickness 1.0 --pixel_size 0.025 --dpi 600
```

Быстрая обработка большого файла с более низким разрешением:
```
python svg2stl.py large-board.svg --thickness 1.0 --pixel_size 0.1 --dpi 150 --max_size 500
```

Сохранение отладочных изображений для проверки обработки:
```
python svg2stl.py board-F_Cu.svg --thickness 1.0 --pixel_size 0.1 --dpi 150 --debug
```
